enum PaymentStatus {
    PENDING
    PARTIAL
    COMPLETED
    REFUNDED
    FAILED
    CANCELLED
}

model Payment {
    id String @id @default(uuid())

    enrollmentId String
    enrollment   Enrollment @relation(fields: [enrollmentId], references: [id])

    amount        Float
    method        String
    transactionId String  @unique
    mobileNumber  String? // পেমেন্ট মোবাইল নম্বর
    reference     String? // ট্রানজেকশন রেফারেন্স

    status PaymentStatus @default(PENDING)
    paidAt DateTime?

    metadata Json? // extra payment info

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([enrollmentId])
    @@index([transactionId])
}

model ActivityLog {
    id String @id @default(uuid())

    enrollmentId String
    enrollment   Enrollment @relation(fields: [enrollmentId], references: [id])

    action    String // ENROLLED, PAYMENT_MADE, CLASS_ATTENDED, COMPLETED_MODULE, etc.
    details   Json?
    ipAddress String?
    userAgent String?

    createdAt DateTime @default(now())

    @@index([enrollmentId])
    @@index([createdAt])
}

model SupportTicket {
    id       String @id @default(uuid())
    ticketNo String @unique

    enrollmentId String
    enrollment   Enrollment @relation(fields: [enrollmentId], references: [id])

    studentId String
    student   User   @relation(fields: [studentId], references: [id])

    subject     String
    description String
    status      String // OPEN, IN_PROGRESS, RESOLVED, CLOSED
    priority    String // LOW, MEDIUM, HIGH, URGENT

    assignedTo String? // support staff ID
    resolvedAt DateTime?

    // messages TicketMessage[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([enrollmentId])
    @@index([status])
}
